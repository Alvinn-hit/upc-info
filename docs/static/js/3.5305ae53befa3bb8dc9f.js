webpackJsonp([3],{"+hoI":function(t,e,a){"use strict";var s={name:"InputBox",mixins:[a("temQ").a],props:["type","placeholder","classes"],data:function(){return{}}},i={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"InputBox",on:{change:this.input}},[e("label",[e("input",{class:this.classes,attrs:{type:this.type,name:this.dataKey,placeholder:this.placeholder},domProps:{value:this.inputValue}})])])},staticRenderFns:[]};var n=a("VU/8")(s,i,!1,function(t){a("zGmg")},"data-v-5216b50c",null);e.a=n.exports},BqCt:function(t,e){},Dn9s:function(t,e){},LJvT:function(t,e){},OIM7:function(t,e,a){"use strict";var s={name:"LoadImage",data:function(){return{loading:a("IaMB")}},props:["loadState"]},i={render:function(){var t=this.$createElement,e=this._self._c||t;return this.loadState?e("div",{staticClass:"box-center text-center"},[e("img",{staticStyle:{width:"133px",height:"80px"},attrs:{src:this.loading,alt:"正在加载中"}})]):this._e()},staticRenderFns:[]},n=a("VU/8")(s,i,!1,null,null,null);e.a=n.exports},Xa6P:function(t,e){},h6Bq:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a("/MSx"),i=a("+hoI"),n={name:"TextBox",mixins:[a("temQ").a],props:["placeholder","classes"],data:function(){return{}}},r={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"TextBox",on:{change:this.input}},[e("label",[e("textarea",{class:this.classes,attrs:{name:this.dataKey,cols:"10",rows:"4",placeholder:this.placeholder},domProps:{value:this.inputValue}})])])},staticRenderFns:[]};var o=a("VU/8")(n,r,!1,function(t){a("BqCt")},"data-v-8cf7d3d8",null).exports,c={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"Upload"},[e("input",{attrs:{type:"file",name:"file",accept:"image/gif, image/png, image/jpg, image/jpeg"},on:{change:this.upload}}),this._v(" "),this._m(0)])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"add-button absolute-center"},[e("div",{staticClass:"add box-center"},[this._v("+")]),this._v(" "),e("p",[this._v("添加")])])}]};var l=a("VU/8")({name:"Upload",data:function(){return{}},methods:{upload:function(t){this.$emit("addFile",t.target)}}},c,!1,function(t){a("Dn9s")},"data-v-428a3f3c",null).exports,u=a("OIM7"),d=a("sOKA"),h=a("nuAC"),p=a("mvHQ"),f=a.n(p);var m=function(){return window.fileList=this.fileList,this.fetch.postJsonData("/secondhand/publish/article",{name:this.managerTitle,kind:f()(this.chooseList.chooseValue),detail:this.managerMessage,imgurl:f()(this.fileList),price:parseFloat(this.managerPrice),degree:"未添加崭新度"})};var v=function(){return this.fetch.postJsonData("/secondhand/publish/updatearticle",{articleid:this.managerId,name:this.managerTitle,kind:f()(this.chooseList.chooseValue),detail:this.managerMessage,imgurl:f()(this.fileList),price:parseFloat(this.managerPrice),degree:"未添加崭新度"})},g=a("mi6u"),x=a("c7dQ"),_=a("/qaa"),b=a("zIJf"),L={name:"PublishPage",props:["articleId"],mixins:[h.a,Object(g.a)(_.a,this),Object(x.a)(_.c),b.a],created:function(){var t=this;this.articleId?(this.postMethod="updateGoods",this.title="编辑",this.fetch.getJsonData("/second/user/info").then(function(e){return t.fetch.getJsonData("/secondhand/browse/onearticle",{articleid:t.articleId}).then(function(a){0===a.code?(alert("文章不存在或已删除！"),t.$router.push("/second/home-page")):e.userid!=a.userid&&(alert("没有权限编辑！"),t.$router.push("/second/home-page")),t.managerId=parseInt(a.id),t.managerTitle=t.$refs.title.inputValue=a.name,t.managerPrice=t.$refs.price.inputValue=a.price,t.managerMessage=t.$refs.message.inputValue=a.detail,t.fileList=JSON.parse(a.imgurl)})})):(this.postMethod="publishGoods",this.title="发布")},data:function(){return{postMethod:"",title:"",managerPrice:"",managerTitle:"",managerMessage:"",fileList:[],chooseList:{chooseValue:[],chooseList:[]}}},components:{HeaderSection:s.a,InputBox:i.a,TextBox:o,Upload:l,Classification:d.a,LoadImage:u.a},methods:{addFile:function(t){var e=this;_.b.fetchFile(t).then(function(t){console.log(t),e.fileList.push(t)})},deleteImage:function(t){var e=parseInt(t.target.dataset.index);this.fileList=this.fileList.filter(function(t,a){return a!==e})},userPublish:function(){var t=this,e=parseInt(this.managerPrice);isNaN(e)?alert("请在价格框中输入数字"):e>=1e5||e<0?alert("别开玩笑啦"):this[this.postMethod]().then(function(e){t.$router.push({path:"/second/home-page"})})},publishGoods:m,updateGoods:v}},y={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"PublishPage box-center second-market"},[a("header-section",[a("p",[t._v(" "+t._s(t.title))])]),t._v(" "),a("load-image",{attrs:{loadState:t.loadState}}),t._v(" "),a("input-box",{ref:"title",staticClass:"input-box box-center",attrs:{type:"text",placeholder:"标题",dataKey:"managerTitle",value:t.managerTitle},on:{userInput:t.updateData}}),t._v(" "),a("input-box",{ref:"price",staticClass:"input-box box-center",attrs:{type:"text",placeholder:"价格",dataKey:"managerPrice",value:t.managerPrice},on:{userInput:t.updateData}}),t._v(" "),a("br"),t._v(" "),a("text-box",{ref:"message",staticClass:"input-box box-center",attrs:{placeholder:"宝贝描述",dataKey:"managerMessage",value:t.managerMessage},on:{userInput:t.updateData}}),t._v(" "),a("div",{staticClass:"file-list input-box box-center"},[t._l(t.fileList,function(e,s){return a("div",{staticClass:"file-item"},[a("div",{staticClass:"add-icon text-center",attrs:{"data-index":s},on:{click:t.deleteImage}},[t._v("+")]),t._v(" "),a("img",{attrs:{src:e,alt:"图片加载失败"}}),t._v(" "),a("div",{staticClass:"file-item-footer text-center"},[t._v(t._s(0===s?"主图":"附图"))])])}),t._v(" "),a("upload",{staticClass:"upload file-item",on:{addFile:t.addFile}})],2),t._v(" "),a("br"),a("br"),t._v(" "),a("div",{staticClass:"clear input-box box-center"},[a("p",{staticStyle:{"font-size":"1rem",color:"#7F7F7F"}},[t._v("分类描述")]),t._v(" "),a("classification",{ref:"classification",attrs:{classesList:t.classesList,dataKey:"chooseList",choosed:t.chooseList.chooseList},on:{choose:t.updateData}})],1),t._v(" "),a("br"),t._v(" "),a("div",{staticClass:"input-box text-center upload-message box-center",on:{click:t.userPublish}},[t._v("\n        确认发布\n    ")])],1)},staticRenderFns:[]};var I=a("VU/8")(L,y,!1,function(t){a("Xa6P")},"data-v-2c78f734",null);e.default=I.exports},sOKA:function(t,e,a){"use strict";var s={name:"Classification",props:{classesList:{type:Array,default:function(){return[]}},dataKey:{type:String},choosed:{type:Array,default:function(){return[]}}},beforeMount:function(){this.chooseList=this._props.choosed},data:function(){return{chooseList:[]}},methods:{choose:function(t){var e=this,a=parseInt(t.target.dataset.index),s=this.chooseList.indexOf(a);-1===s?this.chooseList.push(a):this.chooseList.splice(s,1);var i=this.chooseList.sort().map(function(t){return e._props.classesList[t]});this.$emit("choose",{key:this._props.dataKey,value:{chooseValue:i,chooseList:this.chooseList}})},includes:function(t){return-1===this.chooseList.indexOf(t)?"":"border-color:black;color:black"}}},i={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"Classification"},[a("br"),t._v(" "),a("ul",{staticClass:"clear"},t._l(t.classesList,function(e,s){return a("li",{staticClass:"float-left",style:""+t.includes(s),attrs:{"data-index":s},on:{click:function(e){return e.stopPropagation(),t.choose(e)}}},[a("span",{attrs:{"data-index":s}},[t._v(t._s(e))])])}))])},staticRenderFns:[]};var n=a("VU/8")(s,i,!1,function(t){a("LJvT")},"data-v-a66ec9dc",null);e.a=n.exports},temQ:function(t,e,a){"use strict";e.a={mounted:function(){this._props.value&&(this.inputValue=this._props.value)},props:["value","dataKey"],data:function(){return{inputValue:""}},methods:{input:function(t){this.$emit("userInput",{key:this._props.dataKey,value:t.target.value})}}}},zGmg:function(t,e){},zIJf:function(t,e,a){"use strict";e.a={data:function(){return{classesList:[]}},created:function(){var t=this;this.fetch.getJsonData("/secondhand/browse/allkind").then(function(e){t.classesList=e.map(function(t){return t.name})})}}}});
//# sourceMappingURL=3.5305ae53befa3bb8dc9f.js.map
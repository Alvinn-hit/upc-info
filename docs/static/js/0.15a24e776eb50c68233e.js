webpackJsonp([0],{"/MSx":function(t,e,n){"use strict";var i={render:function(){var t=this.$createElement;return(this._self._c||t)("div",{staticClass:"header"},[this._t("default")],2)},staticRenderFns:[]};var o=n("Z0/y")({name:"HeaderSection",data:function(){return{}}},i,!1,function(t){n("7l/q")},"data-v-dbb65914",null);e.a=o.exports},"/qaa":function(t,e,n){"use strict";var i=n("kuiR"),o=n("hrn7");var r=function(t,e,n,r){var u=new i.a(t),a=new o.b(e,new i.a(t),n,r);return u.yibanAuth=a,{httpRequest:u,yibanAuth:a}},u=n("AA3o"),a=n.n(u),c=n("xSur"),s=n.n(c),h=function(){function t(e,n,i){a()(this,t),this.uploadUrl="/upload/file",this.filePrefix="http://yb.upc.edu.cn",this.httpRequest=e,n&&(this.filePrefix=n),this.uploadUrl=null!==i&&void 0!==i?i:this.uploadUrl}return s()(t,[{key:"fetchFile",value:function(t,e,n){var i=this,o=(n=null!==n&&void 0!==n?n:document).createElement("form");o.appendChild(t.cloneNode());var r=new FormData(o);return"text"===e?this.httpRequest.postTextData(this.uploadUrl,r).then(function(t){return i.filePrefix+"/"+t.data}):this.httpRequest.postJsonData(this.uploadUrl,r).then(function(t){return i.filePrefix+"/"+t.data})}}]),t}();n.d(e,"a",function(){return l}),n.d(e,"c",function(){return d}),n.d(e,"b",function(){return p});var f=r("http://yb.upc.edu.cn:8085","https://openapi.yiban.cn/oauth/authorize?client_id=ee3cf6b53f16b07f&redirect_uri=http://f.yiban.cn/iapp218463","second","mobile"),l=f.httpRequest,d=f.yibanAuth,v=new i.a("http://yb.upc.edu.cn:8084");v.yibanAuth=d;var p=new h(v,"http://yb.upc.edu.cn")},"3cXf":function(t,e,n){t.exports={default:n("LERP"),__esModule:!0}},"7l/q":function(t,e){},AA3o:function(t,e,n){"use strict";e.__esModule=!0,e.default=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}},Dmm8:function(t,e,n){var i=n("34sJ");i(i.S+i.F*!n("GdxE"),"Object",{defineProperty:n("QYYr").f})},IaMB:function(t,e,n){t.exports=n.p+"static/img/loading.e450664.gif"},LERP:function(t,e,n){var i=n("yDNk"),o=i.JSON||(i.JSON={stringify:JSON.stringify});t.exports=function(t){return o.stringify.apply(o,arguments)}},c7dQ:function(t,e,n){"use strict";e.a=function(t){return{data:function(){return{title:"没有设置title,请详细阅读代码文档",yibanAuth:t}},watch:{title:function(t){document.querySelector("title").innerHTML=t}},created:function(){this.yibanAuth&&this.yibanAuth.fetchVq(),document.querySelector("title").innerHTML=this.title}}}},d2gY:function(t,e,n){"use strict";n.d(e,"a",function(){return i}),n.d(e,"c",function(){return o}),n.d(e,"b",function(){return r});var i="http://yb.upc.edu.cn:8084/",o="yb_uid",r="verify_request"},hrn7:function(t,e,n){"use strict";var i=n("3cXf"),o=n.n(i),r=n("AA3o"),u=n.n(r),a=n("xSur"),c=n.n(a),s=function(){function t(e){u()(this,t),this.httpRequest=e}return c()(t,[{key:"fetchTokenByText",value:function(t,e,n){var i=new FormData;return i.append("appName",t),i.append("vq",n),i.append("device",e),fetch(this.httpRequest.commonUrl+"/auth",{method:"POST",body:i}).then(function(t){return t.json()}).then(function(t){return window.sessionStorage.token=t.token,t.token})}}]),t}();var h=function(){var t={},e=window.location.href.split("?")[1].split("&");console.log(e);for(var n=0;n<e.length;n++)t[e[n].split("=")[0]]=e[n].split("=")[1];return t},f=n("kuiR"),l=n("d2gY");n.d(e,"a",function(){return v}),n.d(e,"b",function(){return d});var d=function(){function t(e,n,i,o){u()(this,t),this.yibanIdKey=l.c,this.vqKey=l.b,this.vqUrl=e,this.httpRequest=n,this.appName=i,this.device=o}return c()(t,[{key:"fetchVq",value:function(){!1===this.haveVq()&&(window.localStorage.backUrl=window.location.href,window.location=this.vqUrl)}},{key:"haveVq",value:function(){var t=this.getVq();return null!==t&&void 0!==t}},{key:"getVq",value:function(){var t=this.getVqByUrl();return null!==t&&void 0!==t?(this.setVq(t),t):window.sessionStorage.vq}},{key:"setVq",value:function(t){window.sessionStorage.vq=t}},{key:"refreshToken",value:function(){return new s(this.httpRequest).fetchTokenByText(this.appName,this.device,this.getVq())}},{key:"getVqByUrl",value:function(){var t=window.location.href;if(!t.includes("?")&&!t.includes("=")&&!t.includes(this.vqKey))return null;var e=h();return console.log(e),window.sessionStorage.yibanId=e[l.c],window.sessionStorage.vq=e[l.b],window.location=window.localStorage.backUrl,e[l.b]}}]),t}(),v=function(){function t(){u()(this,t)}return c()(t,null,[{key:"haveLocalToken",value:function(){var t=window.sessionStorage.token;return null!==t&&void 0!==t&&"null"!==t&&"undefined"!==t}},{key:"getLocalToken",value:function(){return window.sessionStorage.token}},{key:"haveLocalUserData",value:function(){var t=window.sessionStorage.userData;return null!==t&&void 0!==t&&"null"!==t&&"undefined"!==t}},{key:"getLocalUserData",value:function(){return JSON.parse(window.sessionStorage.userData)}},{key:"fetchUserData",value:function(){var t={yibanId:"yb_userid",exp:"yb_exp",money:"yb_money",schoolId:"yb_schoolid",schoolName:"yb_schoolname",sex:"yb_sex",userName:"yb_username",userNick:"yb_usernick"};return new f.a("http://yb.upc.edu.cn:8084").getJsonData("/leinuo/weekcp/user/getYiMeByToken").then(function(e){var n=JSON.parse(e.data);for(var i in t)n[i]=n[t[i]];return window.sessionStorage.userData=o()(n),n})}}]),t}()},kuiR:function(t,e,n){"use strict";var i=n("AA3o"),o=n.n(i),r=n("xSur"),u=n.n(r),a=n("d2gY"),c=n("hrn7"),s=(n("/qaa"),function(){function t(e){var n=this;o()(this,t),h.call(this),this.commonUrl=null!==e&&void 0!==e?e:this.commonUrl,this.addFetchListen("error",function(t){window.r=t,"TypeError: Failed to fetch"===t.toString()&&n.yibanAuth&&n.yibanAuth.haveVq()&&alert("请检查网络连接")})}return u()(t,[{key:"addFetchListen",value:function(t,e){"before"===t?this._fetchBefore.push(e):"after"===t?this._fetchAfter.push(e):this._fetchError.push(e)}},{key:"removeFetchListen",value:function(t,e){var n=void 0;"before"===t?-1!==(n=this._fetchBefore.indexOf(e))&&this._fetchBefore.splice(n,1):"after"===t?-1!==(n=this._fetchAfter.indexOf(e))&&this._fetchAfter.splice(n,1):-1!==(n=this._fetchError.indexOf(e))&&this._fetchError.splice(n,1)}},{key:"_fetchCheckToken",value:function(t,e,n){var i=this;return!c.a.haveLocalToken()&&this.yibanAuth?this.yibanAuth.refreshToken().then(function(){return i._fetchWithListener(t,e,n)}):this._fetchWithListener(t,e,n)}},{key:"_fetchWithListener",value:function(t,e,n){var i=this,o=void 0;if("GET"===t.toUpperCase())o=this._getData.bind(this);else{if("POST"!==t.toUpperCase())return console.log("不支持提交put与delete方法");o=this._postData.bind(this)}return this._fetchBefore&&this._fetchBefore.forEach(function(t){return t(e,n)}),o(e,n).catch(function(t){return alert(t.toString()),i._fetchError&&i._fetchError.forEach(function(e){return e(t)})}).then(function(t){return i._fetchAfter&&i._fetchAfter.forEach(function(e){return e(t)}),t})}},{key:"_getData",value:function(t,e){for(var n in t+="?",e)e.hasOwnProperty(n)&&(t+=n+"="+e[n]+"&");return t+="Authorization="+c.a.getLocalToken(),t=this.commonUrl+t,console.log("get method",t),fetch(t,{method:"get"})}},{key:"_postData",value:function(t,e){t+="?Authorization="+c.a.getLocalToken();var n=new FormData;if(e instanceof FormData)n=e;else for(var i in e)e.hasOwnProperty(i)&&n.append(i,e[i]);return console.log("POST method",this.commonUrl+t,e),fetch(this.commonUrl+t,{method:"post",body:n})}},{key:"checkJsonData",value:function(t){return t.status&&500===t.status}},{key:"getJsonData",value:function(t,e){var n=this;return this._fetchCheckToken("get",t,e).then(function(t){return t.json()}).then(function(i){return n.checkJsonData(i)&&console.log("与后端交互出错","GET "+t,e),i})}},{key:"getTextData",value:function(t,e){return this._fetchCheckToken("get",t,e).then(function(t){return t.text()})}},{key:"postJsonData",value:function(t,e){var n=this;return this._fetchCheckToken("post",t,e).then(function(t){return t.json()}).then(function(i){return n.checkJsonData(i)&&console.log("与后端交互出错","POST "+t,e),i})}},{key:"postTextData",value:function(t,e){return this._fetchCheckToken("post",t,e).then(function(t){return t.text()})}}]),t}()),h=function(){this.commonUrl=a.a,this._fetchBefore=[],this._fetchAfter=[],this._fetchError=[]};e.a=s},liLe:function(t,e,n){t.exports={default:n("zg6Y"),__esModule:!0}},mi6u:function(t,e,n){"use strict";e.a=function(t){return{data:function(){return{loadState:!1,fetch:t}},methods:{showLoading:function(){this.loadState=!0},hiddenLoading:function(){this.loadState=!1}},created:function(){this.fetch.addFetchListen("before",this.showLoading),this.fetch.addFetchListen("after",this.hiddenLoading)},beforeDestroy:function(){this.fetch.removeFetchListen("before",this.showLoading),this.fetch.removeFetchListen("after",this.hiddenLoading)}}}},nuAC:function(t,e,n){"use strict";var i={methods:{updateData:function(t){console.log(t),this[t.key]=t.value}}};e.a=i},xSur:function(t,e,n){"use strict";e.__esModule=!0;var i,o=n("liLe"),r=(i=o)&&i.__esModule?i:{default:i};e.default=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}()},zg6Y:function(t,e,n){n("Dmm8");var i=n("yDNk").Object;t.exports=function(t,e,n){return i.defineProperty(t,e,n)}}});
//# sourceMappingURL=0.15a24e776eb50c68233e.js.map